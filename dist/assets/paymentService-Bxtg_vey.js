const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/payment-DM5lAAXh.js","assets/vendor-wpXbf5jk.js"])))=>i.map(i=>d[i]);
var m=Object.defineProperty;var l=(t,e,r)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var c=(t,e,r)=>l(t,typeof e!="symbol"?e+"":e,r);import{_ as p}from"./index-B6nm7sb2.js";const i={razorpay:{keyId:"rzp_test_your_key_id",keySecret:"your_key_secret",currency:"INR",name:"Tripsera Travels",description:"Travel Booking Payment",image:"/tripsera-logo.png",theme:{color:"#f97316"}},stripe:{publishableKey:"pk_test_your_publishable_key",secretKey:"sk_test_your_secret_key",currency:"inr"},methods:[{id:"razorpay",name:"Razorpay",description:"Pay with UPI, Cards, Net Banking",icon:"💳",enabled:!0},{id:"stripe",name:"Stripe",description:"International payment processing",icon:"🌍",enabled:!0},{id:"upi",name:"UPI",description:"Pay with UPI ID or QR Code",icon:"📱",enabled:!0},{id:"netbanking",name:"Net Banking",description:"Pay with your bank account",icon:"🏦",enabled:!0},{id:"wallet",name:"Digital Wallet",description:"Paytm, PhonePe, Google Pay",icon:"💰",enabled:!0}],status:{PENDING:"pending",PROCESSING:"processing",COMPLETED:"completed",FAILED:"failed",CANCELLED:"cancelled",REFUNDED:"refunded"}};class y{static loadScript(){return new Promise(e=>{const r=document.createElement("script");r.src="https://checkout.razorpay.com/v1/checkout.js",r.onload=()=>e(!0),r.onerror=()=>e(!1),document.body.appendChild(r)})}static async initializePayment(e){try{if(!await this.loadScript())throw new Error("Failed to load Razorpay script");const a={key:i.razorpay.keyId,amount:e.amount*100,currency:e.currency,name:i.razorpay.name,description:e.description,image:i.razorpay.image,order_id:e.orderId,handler:async o=>({success:!0,paymentId:o.razorpay_payment_id,orderId:o.razorpay_order_id,transactionId:o.razorpay_signature,amount:e.amount,currency:e.currency,status:"completed",message:"Payment successful"}),prefill:{name:e.customerName,email:e.customerEmail,contact:e.customerPhone},theme:i.razorpay.theme,modal:{ondismiss:()=>({success:!1,status:"cancelled",message:"Payment cancelled by user"})}},n=new window.Razorpay(a);return await new Promise(o=>{n.on("payment.failed",d=>{o({success:!1,status:"failed",message:"Payment failed",error:d.error.description})}),n.open()})}catch(r){return{success:!1,status:"failed",message:"Payment initialization failed",error:r instanceof Error?r.message:"Unknown error"}}}}class u{static async loadStripe(){if(this.stripe)return this.stripe;const{loadStripe:e}=await p(async()=>{const{loadStripe:r}=await import("./payment-DM5lAAXh.js").then(a=>a.s);return{loadStripe:r}},__vite__mapDeps([0,1]));return this.stripe=await e(i.stripe.publishableKey),this.stripe}static async initializePayment(e){try{const r=await this.loadStripe();if(!r)throw new Error("Failed to load Stripe");const a=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e.amount,currency:e.currency,customerId:e.customerId,bookingId:e.bookingId})}),{clientSecret:n}=await a.json(),s=await r.confirmCardPayment(n,{payment_method:{card:{},billing_details:{name:e.customerName,email:e.customerEmail,phone:e.customerPhone}}});return s.error?{success:!1,status:"failed",message:"Payment failed",error:s.error.message}:{success:!0,paymentId:s.paymentIntent.id,amount:e.amount,currency:e.currency,status:"completed",message:"Payment successful"}}catch(r){return{success:!1,status:"failed",message:"Payment initialization failed",error:r instanceof Error?r.message:"Unknown error"}}}}c(u,"stripe",null);class P{static async initializePayment(e){try{const r="tripsera@paytm",a=e.amount,n=`Payment for ${e.description}`,s=`upi://pay?pa=${r}&am=${a}&cu=${e.currency}&tn=${encodeURIComponent(n)}`;return window.location.href=s,{success:!0,status:"processing",message:"Redirecting to UPI app..."}}catch(r){return{success:!1,status:"failed",message:"UPI payment failed",error:r instanceof Error?r.message:"Unknown error"}}}}class g{static async processPayment(e,r){switch(e){case"razorpay":return await y.initializePayment(r);case"stripe":return await u.initializePayment(r);case"upi":return await P.initializePayment(r);default:return{success:!1,status:"failed",message:"Payment method not supported",error:"Invalid payment method"}}}static generateOrderId(){return`order_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static formatAmount(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e)}}export{g as P,i as a};
