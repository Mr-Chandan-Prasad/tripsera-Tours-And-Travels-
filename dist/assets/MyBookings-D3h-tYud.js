import{u as x,j as e,L as U}from"./index-B6nm7sb2.js";import{r as n}from"./vendor-wpXbf5jk.js";import{T as Q}from"./TicketGenerator-DM_7W7F-.js";import{f as R,g as V,C as v,U as I,n as Y,a as $,D as q,u,v as w,E as z,m as G}from"./ui-BrVeeXSi.js";import"./router-DXsjaEeh.js";const W=()=>{const[a,C]=n.useState(""),[r,S]=n.useState(""),[i,_]=n.useState(""),[o,k]=n.useState("all"),[c,h]=n.useState(null),[L,g]=n.useState(!1),[p,j]=n.useState(!1),{data:y,loading:B}=x("bookings",[]),{data:D}=x("destinations",[]),{data:M}=x("services",[]),f=y.filter(s=>p&&(a.trim()&&s.email&&s.email.toLowerCase()===a.toLowerCase()||r.trim()&&s.mobile&&s.mobile===r.trim())),b=f.filter(s=>{const l=!i||s.customer_name.toLowerCase().includes(i.toLowerCase())||d(s.destination_id).toLowerCase().includes(i.toLowerCase())||m(s.service_id).toLowerCase().includes(i.toLowerCase()),t=o==="all"||s.payment_status===o;return l&&t}),d=s=>{const l=D.find(t=>t.id===s);return l?l.name:"Unknown Destination"},m=s=>{const l=M.find(t=>t.id===s);return l?l.name:"Unknown Service"},E=s=>{if(s.preventDefault(),!a.trim()&&!r.trim()){alert("Please enter either email or mobile number");return}if(y.filter(t=>{const A=a.trim()&&t.email&&t.email.toLowerCase()===a.toLowerCase(),F=r.trim()&&t.mobile&&t.mobile===r.trim();return A||F}).length===0){alert("No bookings found for the provided email or mobile number. Please check your details or make a booking first.");return}a.trim()||r.trim()?j(!0):alert("Please enter valid email or mobile number")},N=s=>{h(s),g(!0)},P=s=>{switch(s){case"paid":return e.jsx(G,{className:"w-5 h-5 text-green-500"});case"pending":return e.jsx(u,{className:"w-5 h-5 text-yellow-500"});case"cancelled":return e.jsx(w,{className:"w-5 h-5 text-red-500"});default:return e.jsx(u,{className:"w-5 h-5 text-gray-500"})}},T=s=>{switch(s){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return B?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your bookings..."})]})}):p?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:[e.jsxs("div",{className:"container mx-auto px-6 py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"My Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Manage and track your travel bookings"})]}),e.jsx("button",{onClick:()=>j(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Switch Account"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",value:i,onChange:s=>_(s.target.value),placeholder:"Search bookings...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsxs("select",{value:o,onChange:s=>k(s.target.value),className:"pl-10 pr-8 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})]}),b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-lg mx-auto mb-4 flex items-center justify-center",children:e.jsx(v,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-2xl font-semibold text-gray-600 mb-2",children:"No Bookings Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:f.length===0?"You haven't made any bookings yet.":"No bookings match your search criteria."}),e.jsx("a",{href:"/bookings",className:"inline-block bg-gradient-to-r from-orange-500 to-yellow-500 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg",children:"Book Your First Trip"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:b.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:d(s.destination_id)}),e.jsx("p",{className:"text-gray-600",children:m(s.service_id)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[P(s.payment_status),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${T(s.payment_status)}`,children:s.payment_status.toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:new Date(s.booking_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[s.seats_selected||1," ",(s.seats_selected||1)===1?"Person":"People"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["₹",(s.amount||s.total_amount||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx($,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Booking #",s.id.slice(-6)]})]})]}),s.details&&e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[e.jsx("strong",{children:"Special Requests:"})," ",s.details]})}),e.jsxs("div",{className:"flex space-x-3",children:[s.payment_status==="paid"&&e.jsxs("button",{onClick:()=>N(s),className:"flex-1 flex items-center justify-center space-x-2 bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Download Ticket"})]}),s.payment_status==="pending"&&e.jsxs("div",{className:"flex-1 flex items-center justify-center space-x-2 bg-yellow-100 text-yellow-800 py-2 px-4 rounded-lg",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{children:"Payment Pending"})]}),s.payment_status==="cancelled"&&e.jsxs("div",{className:"flex-1 flex items-center justify-center space-x-2 bg-red-100 text-red-800 py-2 px-4 rounded-lg",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Booking Cancelled"})]}),e.jsxs("button",{onClick:()=>N(s),className:"flex items-center justify-center space-x-2 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"View Details"})]})]})]}),e.jsx("div",{className:"bg-gray-50 px-6 py-3",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Booked on ",new Date(s.created_at||Date.now()).toLocaleDateString(),s.transaction_id&&` • Transaction: ${s.transaction_id}`]})})]},s.id))})]}),L&&c&&e.jsx(Q,{bookingData:c,destinationName:d(c.destination_id),serviceName:m(c.service_id),onClose:()=>{g(!1),h(null)}})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:e.jsx("div",{className:"container mx-auto px-6 py-12",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"My Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Enter your email or mobile number to view your bookings"})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:a,onChange:s=>C(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Enter your email"})]}),e.jsx("div",{className:"text-center text-gray-500",children:"OR"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number"}),e.jsx("input",{type:"tel",value:r,onChange:s=>S(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Enter your mobile number"})]}),e.jsx("button",{type:"submit",disabled:!a.trim()&&!r.trim(),className:"w-full bg-gradient-to-r from-orange-500 to-yellow-500 text-white py-3 px-6 rounded-lg font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"View My Bookings"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Don't have any bookings yet?"," ",e.jsx("a",{href:"/bookings",className:"text-orange-500 hover:text-orange-600 font-semibold",children:"Book Now"})]})})]})})})})};export{W as default};
